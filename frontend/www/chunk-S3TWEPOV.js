import{a as b}from"./chunk-6AVC4IZC.js";import{a as c,b as u}from"./chunk-B4WDAWNQ.js";import{f as d,h}from"./chunk-OM4WM6OA.js";import{f as l}from"./chunk-RW4GY4BD.js";var E=(()=>{let e=class e{constructor(r){this.trabajadorService=r,this.baseUrl=`${u.url}recogidas`}handleError(r){throw console.error("Error en recogidas.service:",r),r}actualizarTotalesTrabajador(r){return l(this,null,function*(){try{let t=(yield this.getAllByTrabajador(parseInt(r))).reduce((g,j)=>g+j.kilos,0),o=yield this.trabajadorService.getTrabajadorById(parseInt(r)),s=o[0].precioPorKilo||1.5,p=t*s,n={id:o[0].id,nombre:o[0].nombre,kilos:t,ganancia:p,precioPorKilo:s};return console.log(n),yield this.trabajadorService.updateTrabajador(parseInt(r),n),!0}catch(a){throw console.error(`Error al actualizar totales del trabajador ${r}:`,a),a}})}getAllByTrabajador(r){let a=`${this.baseUrl}/${r}`;return c.get({url:a}).then(t=>t.data).catch(this.handleError)}getById(r){let a=`${this.baseUrl}/recogida/${r}`;return c.get({url:a}).then(t=>t.data).catch(this.handleError)}getByFechaAndTrabajador(r,a){let t=`${this.baseUrl}/buscar-por-fecha?fecha=${r}&idTrabajador=${a}`;return c.get({url:t}).then(o=>o.data).catch(this.handleError)}createRecogida(r){let a=`${this.baseUrl}`;return c.post({url:a,data:r}).then(t=>t.data).catch(this.handleError)}updateRecogida(r,a){let t=`${this.baseUrl}/${r}`;return c.put({url:t,data:a}).then(o=>o.data).catch(this.handleError)}deleteRecogida(r){let a=`${this.baseUrl}/${r}`;return c.delete({url:a}).then(()=>{}).catch(this.handleError)}};e.\u0275fac=function(a){return new(a||e)(h(b))},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();export{E as a};
