import{a as X}from"./chunk-UERLDVYF.js";import{f as Q,h as W}from"./chunk-IJCEFDFP.js";import"./chunk-TK637REM.js";import"./chunk-PSDQXRQ7.js";import"./chunk-YYK6W2VS.js";import"./chunk-FAPPJNJW.js";import"./chunk-HC6MZPB3.js";import"./chunk-4PGTP63H.js";import"./chunk-QRJ5Z3B6.js";import"./chunk-FERD25SW.js";import"./chunk-PCR4Q3CI.js";import"./chunk-LEIMCQKJ.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-E76BAXQI.js";import"./chunk-MCRJI3T3.js";import"./chunk-B4WDAWNQ.js";import{K as U,L as $,X as H,Z as J,a as B,d as L,e as R,fa as K}from"./chunk-JZDIRMBR.js";import"./chunk-KJ4DQJJ6.js";import"./chunk-4DDT52NB.js";import"./chunk-5U5GTFKZ.js";import"./chunk-XDLFVO2Q.js";import{F as G,l as D}from"./chunk-EXSP2FB6.js";import{$ as m,A as C,Aa as S,Ab as q,Cb as Y,D as g,F as y,L as t,M as e,N as c,R as O,S as b,T as p,aa as w,hb as I,jb as M,kb as A,l as u,lb as z,m as _,pb as F,qa as k,qb as T,rb as V,t as s,u as l,ub as j,w as v,ya as E,zb as N}from"./chunk-OM4WM6OA.js";import"./chunk-QWLURI7L.js";import"./chunk-7KGURMOZ.js";import"./chunk-746R66HB.js";import"./chunk-22YGHXDB.js";import"./chunk-A5VEOJWE.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-4DUJ2VZY.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as x,b as h,f}from"./chunk-RW4GY4BD.js";function tn(r,d){r&1&&(t(0,"div",10)(1,"div",11),c(2,"div",12),e(),t(3,"p"),m(4,"Cargando datos del abono..."),e()())}function en(r,d){if(r&1){let a=O();t(0,"div",13)(1,"div",14),c(2,"ion-icon",15),e(),t(3,"p"),m(4),e(),t(5,"button",16),b("click",function(){u(a);let o=p();return _(o.cargarAbono())}),c(6,"ion-icon",17),t(7,"span"),m(8,"Reintentar"),e()()()}if(r&2){let a=p();s(4),w(a.errorMessage)}}function on(r,d){r&1&&(t(0,"div",36),m(1," El nombre es obligatorio "),e())}function rn(r,d){if(r&1){let a=O();t(0,"div",18)(1,"form",19),b("ngSubmit",function(){u(a);let o=p();return _(o.guardarAbono())}),t(2,"div",20)(3,"div",21)(4,"label",22),m(5,"Nombre "),t(6,"span",23),m(7,"*"),e()()(),t(8,"div",24)(9,"div",25),c(10,"ion-icon",26),e(),c(11,"input",27),e(),C(12,on,2,0,"div",28),e(),t(13,"div",20)(14,"div",21)(15,"label",29),m(16,"Cantidad"),e()(),t(17,"div",24)(18,"div",25),c(19,"ion-icon",30),e(),c(20,"input",31),e()(),c(21,"input",32),t(22,"div",33)(23,"button",34),c(24,"ion-icon",35),t(25,"span"),m(26,"Actualizar Abono"),e()()()()()}if(r&2){let a=p();s(),g("formGroup",a.abonoForm),s(7),y("has-error",a.hasError("nombre","required")),s(4),g("ngIf",a.hasError("nombre","required")),s(11),g("disabled",a.abonoForm.invalid||a.isSubmitting)}}var un=(()=>{let d=class d{constructor(n,o,i,P,Z,nn){this.formBuilder=n,this.router=o,this.route=i,this.abonoService=P,this.alertController=Z,this.toastController=nn,this.isSubmitting=!1,this.isLoading=!1,this.loadError=!1,this.errorMessage="",this.abonoForm=this.createForm(),this.abonoId=parseInt(this.route.snapshot.paramMap.get("id")||"0")}ngOnInit(){B({arrowBackOutline:R,alertCircleOutline:L,refreshOutline:H,leafOutline:$,layersOutline:U,saveOutline:J,trashOutline:K}),this.abonoId?this.cargarAbono():(this.errorMessage="ID de abono no v\xE1lido",this.loadError=!0)}createForm(){return this.formBuilder.group({nombre:["",[M.required]],cantidad:[null],tipo:["abono"],idUsuario:[null,[M.required]]})}cargarAbono(){return f(this,null,function*(){this.isLoading=!0,this.loadError=!1;try{this.abonoOriginal=yield this.abonoService.getAbonoById(this.abonoId),this.abonoForm.patchValue({nombre:this.abonoOriginal.nombre,cantidad:this.abonoOriginal.cantidad,tipo:this.abonoOriginal.tipo||"abono",idUsuario:this.abonoOriginal.idUsuario})}catch(n){console.error("Error al cargar abono:",n),this.loadError=!0,this.errorMessage="Error al cargar los datos del abono. Verifica tu conexi\xF3n e int\xE9ntalo de nuevo."}finally{this.isLoading=!1}})}hasError(n,o){let i=this.abonoForm.get(n);return!!(i&&i.hasError(o)&&(i.dirty||i.touched))}guardarAbono(){return f(this,null,function*(){if(this.abonoForm.invalid){this.markFormGroupTouched();return}this.isSubmitting=!0;try{let n=h(x({},this.abonoForm.value),{tipo:"abono"});yield this.abonoService.updateAbono(this.abonoId,n),yield this.mostrarToast("Abono actualizado correctamente","success"),this.volver()}catch(n){console.error("Error al actualizar abono:",n),yield this.mostrarToast("Error al actualizar el abono","danger")}finally{this.isSubmitting=!1}})}confirmarEliminar(){return f(this,null,function*(){if(!this.abonoOriginal)return;yield(yield this.alertController.create({header:"Confirmar eliminaci\xF3n",message:`\xBFEst\xE1s seguro de que quieres eliminar el abono "${this.abonoOriginal.nombre}"?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"destructive",handler:()=>{this.eliminarAbono()}}]})).present()})}eliminarAbono(){return f(this,null,function*(){this.isSubmitting=!0;try{yield this.abonoService.deleteAbono(this.abonoId),yield this.mostrarToast("Abono eliminado correctamente","success"),this.volver()}catch(n){console.error("Error al eliminar abono:",n),yield this.mostrarToast("Error al eliminar el abono","danger")}finally{this.isSubmitting=!1}})}markFormGroupTouched(){Object.keys(this.abonoForm.controls).forEach(n=>{let o=this.abonoForm.get(n);o&&o.markAsTouched()})}volver(){this.router.navigate(["/abonos"])}mostrarToast(n,o){return f(this,null,function*(){yield(yield this.toastController.create({message:n,duration:3e3,color:o,position:"bottom"})).present()})}};d.\u0275fac=function(o){return new(o||d)(l(q),l(S),l(E),l(X),l(Q),l(W))},d.\u0275cmp=v({type:d,selectors:[["app-editar-abono"]],decls:14,vars:3,consts:[[1,"ion-content-editar-abono"],[1,"premium-editar-abono-container"],[1,"section-header"],[1,"header-back-button"],[1,"back-button",3,"click"],["name","arrow-back-outline"],[1,"header-content"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","form-container",4,"ngIf"],[1,"loading-container"],[1,"loading-spinner"],[1,"spinner"],[1,"error-container"],[1,"error-icon"],["name","alert-circle-outline"],[1,"retry-button",3,"click"],["name","refresh-outline"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-label"],["for","nombre"],[1,"required"],[1,"input-container"],[1,"input-icon"],["name","leaf-outline"],["type","text","id","nombre","formControlName","nombre","placeholder","Nombre del abono",1,"form-input"],["class","error-message",4,"ngIf"],["for","cantidad"],["name","layers-outline"],["type","number","id","cantidad","formControlName","cantidad","placeholder","Cantidad disponible","min","0",1,"form-input"],["type","hidden","formControlName","tipo","value","abono"],[1,"form-actions"],["type","submit",1,"save-button",3,"disabled"],["name","save-outline"],[1,"error-message"]],template:function(o,i){o&1&&(t(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),b("click",function(){return i.volver()}),c(5,"ion-icon",5),t(6,"span"),m(7,"Volver"),e()()(),t(8,"div",6)(9,"h1"),m(10,"Editar Abono"),e()()(),C(11,tn,5,0,"div",7)(12,en,9,1,"div",8)(13,rn,27,5,"div",9),e()()),o&2&&(s(11),g("ngIf",i.isLoading),s(),g("ngIf",i.loadError),s(),g("ngIf",!i.isLoading&&!i.loadError))},dependencies:[G,Y,F,I,T,A,z,N,V,j,k,D],styles:['@charset "UTF-8";.premium-editar-abono-container[_ngcontent-%COMP%]{padding:20px;min-height:100%;background-color:#0a1e3f;color:#fff}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:30px}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]{margin-bottom:16px}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:8px;padding:8px 16px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:translateY(-2px)}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#fff;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.2)}.premium-editar-abono-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;background:#ffffff1a;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-abono-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{margin-bottom:20px}.premium-editar-abono-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#4caf50;animation:_ngcontent-%COMP%_spin 1s linear infinite}.premium-editar-abono-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#ffffffe6;text-align:center;margin:0}.premium-editar-abono-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;background:#ffffff1a;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-abono-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{margin-bottom:20px}.premium-editar-abono-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:50px;color:#ff5252}.premium-editar-abono-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#ffffffe6;text-align:center;margin:0 0 20px}.premium-editar-abono-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:8px;padding:8px 16px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.premium-editar-abono-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.premium-editar-abono-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:translateY(-2px)}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{background:#ffffff26;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;padding:24px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:24px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fff}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ff5252;margin-left:4px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff1a;border-radius:12px;border:1px solid rgba(255,255,255,.2);overflow:hidden;transition:all .3s ease}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:focus-within{border-color:#fff6;box-shadow:0 0 0 2px #ffffff1a}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container.has-error[_ngcontent-%COMP%]{border-color:#ff5252;box-shadow:0 0 0 2px #ff525233}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:50px;color:#ffffffb3;font-size:20px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;color:#fff;padding:14px 16px 14px 0;font-size:16px;font-family:inherit}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:#ffffff80}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:8px;color:#ff5252;font-size:14px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]:before{content:"\\2022";margin-right:6px;font-size:16px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin-top:32px;display:flex;flex-direction:column;gap:12px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;background:linear-gradient(135deg,#00796b,#4caf50);color:#fff;border:none;border-radius:12px;padding:16px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 8px 20px #0003}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;margin-right:8px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000004d}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 6px 15px #0003}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:disabled{background:#ffffff1a;color:#ffffff80;box-shadow:none;cursor:not-allowed}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;background:linear-gradient(135deg,#ff5252,#d32f2f);color:#fff;border:none;border-radius:12px;padding:16px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 8px 20px #0003}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;margin-right:8px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000004d}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 6px 15px #0003}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]:disabled{background:#ffffff1a;color:#ffffff80;box-shadow:none;cursor:not-allowed}@media (min-width: 768px){.premium-editar-abono-container[_ngcontent-%COMP%]{padding:30px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{flex-direction:row;gap:16px}.premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%], .premium-editar-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{flex:1}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{flex-direction:row;align-items:center}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]{margin-bottom:0;margin-right:20px}.premium-editar-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.form-container[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.ion-content-editar-abono[_ngcontent-%COMP%]{--background: #0a1e3f;--padding-top: 30px}']});let r=d;return r})();export{un as EditarAbonoPage};
