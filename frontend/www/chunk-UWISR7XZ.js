import{h as Y}from"./chunk-IJCEFDFP.js";import"./chunk-TK637REM.js";import"./chunk-PSDQXRQ7.js";import{a as R}from"./chunk-LQJ4GJFR.js";import"./chunk-YYK6W2VS.js";import"./chunk-FAPPJNJW.js";import"./chunk-HC6MZPB3.js";import"./chunk-4PGTP63H.js";import"./chunk-QRJ5Z3B6.js";import"./chunk-FERD25SW.js";import"./chunk-PCR4Q3CI.js";import"./chunk-LEIMCQKJ.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-E76BAXQI.js";import"./chunk-MCRJI3T3.js";import{a as D}from"./chunk-6HKVC6LK.js";import{K as V,L as q,Z as B,a as G,e as U}from"./chunk-JZDIRMBR.js";import"./chunk-B4WDAWNQ.js";import"./chunk-KJ4DQJJ6.js";import"./chunk-4DDT52NB.js";import"./chunk-5U5GTFKZ.js";import"./chunk-XDLFVO2Q.js";import{F as j,l as z}from"./chunk-EXSP2FB6.js";import{$ as a,A as M,Aa as x,Ab as N,Cb as T,D as g,F as P,L as e,M as r,N as i,S as l,aa as p,hb as y,jb as b,kb as k,lb as w,pb as E,qa as h,qb as S,rb as I,t as m,u as s,ub as A,w as O,ya as v,zb as F}from"./chunk-OM4WM6OA.js";import"./chunk-QWLURI7L.js";import"./chunk-7KGURMOZ.js";import"./chunk-746R66HB.js";import"./chunk-22YGHXDB.js";import"./chunk-A5VEOJWE.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-4DUJ2VZY.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as C,b as _,f}from"./chunk-RW4GY4BD.js";function J(u,c){u&1&&(e(0,"div",25),a(1," El nombre es obligatorio "),r())}var an=(()=>{let c=class c{constructor(n,t,o,d,L,H){this.formBuilder=n,this.router=t,this.route=o,this.abonoService=d,this.toastController=L,this.loginService=H,this.isSubmitting=!1,this.esEdicion=!1,this.idUsuario=this.loginService.getIdUsuario(),this.abonoForm=this.createForm()}ngOnInit(){G({arrowBackOutline:U,leafOutline:q,layersOutline:V,saveOutline:B}),this.route.params.subscribe(n=>{n.id&&(this.esEdicion=!0,this.abonoId=parseInt(n.id),this.cargarAbono())})}createForm(){return this.formBuilder.group({nombre:["",[b.required]],cantidad:[null],tipo:["abono"],idUsuario:[this.idUsuario,[b.required]]})}cargarAbono(){return f(this,null,function*(){if(this.abonoId)try{let n=yield this.abonoService.getAbonoById(this.abonoId);this.abonoForm.patchValue({nombre:n.nombre,cantidad:n.cantidad,tipo:n.tipo||"abono",idUsuario:n.idUsuario})}catch(n){console.error("Error al cargar abono:",n),yield this.mostrarToast("Error al cargar los datos del abono","danger"),this.volver()}})}hasError(n,t){let o=this.abonoForm.get(n);return!!(o&&o.hasError(t)&&(o.dirty||o.touched))}guardarAbono(){return f(this,null,function*(){if(this.abonoForm.invalid){this.markFormGroupTouched();return}this.isSubmitting=!0;try{let n=_(C({},this.abonoForm.value),{tipo:"abono"});this.esEdicion&&this.abonoId?(yield this.abonoService.updateAbono(this.abonoId,n),this.mostrarToast("Abono actualizado correctamente","success")):(yield this.abonoService.createAbono(n),this.mostrarToast("Abono creado correctamente","success")),this.volver()}catch(n){console.error("Error al guardar abono:",n);let t=this.esEdicion?"Error al actualizar el abono":"Error al crear el abono";this.mostrarToast(t,"danger")}finally{this.isSubmitting=!1}})}markFormGroupTouched(){Object.keys(this.abonoForm.controls).forEach(n=>{let t=this.abonoForm.get(n);t&&t.markAsTouched()})}volver(){this.router.navigate(["/abonos"])}mostrarToast(n,t){return f(this,null,function*(){yield(yield this.toastController.create({message:n,duration:3e3,color:t,position:"bottom"})).present()})}};c.\u0275fac=function(t){return new(t||c)(s(N),s(x),s(v),s(R),s(Y),s(D))},c.\u0275cmp=O({type:c,selectors:[["app-nuevo-abono"]],decls:38,vars:7,consts:[[1,"ion-content-nuevo-abono"],[1,"premium-nuevo-abono-container"],[1,"section-header"],[1,"header-back-button"],[1,"back-button",3,"click"],["name","arrow-back-outline"],[1,"header-content"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-label"],["for","nombre"],[1,"required"],[1,"input-container"],[1,"input-icon"],["name","leaf-outline"],["type","text","id","nombre","formControlName","nombre","placeholder","Nombre del abono",1,"form-input"],["class","error-message",4,"ngIf"],["for","cantidad"],["name","layers-outline"],["type","number","id","cantidad","formControlName","cantidad","placeholder","Cantidad disponible","min","0",1,"form-input"],["type","hidden","formControlName","tipo","value","abono"],[1,"form-actions"],["type","submit",1,"save-button",3,"disabled"],["name","save-outline"],[1,"error-message"]],template:function(t,o){t&1&&(e(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),l("click",function(){return o.volver()}),i(5,"ion-icon",5),e(6,"span"),a(7,"Volver"),r()()(),e(8,"div",6)(9,"h1"),a(10),r()()(),e(11,"div",7)(12,"form",8),l("ngSubmit",function(){return o.guardarAbono()}),e(13,"div",9)(14,"div",10)(15,"label",11),a(16,"Nombre "),e(17,"span",12),a(18,"*"),r()()(),e(19,"div",13)(20,"div",14),i(21,"ion-icon",15),r(),i(22,"input",16),r(),M(23,J,2,0,"div",17),r(),e(24,"div",9)(25,"div",10)(26,"label",18),a(27,"Cantidad"),r()(),e(28,"div",13)(29,"div",14),i(30,"ion-icon",19),r(),i(31,"input",20),r()(),i(32,"input",21),e(33,"div",22)(34,"button",23),i(35,"ion-icon",24),e(36,"span"),a(37),r()()()()()()()),t&2&&(m(10),p(o.esEdicion?"Editar Abono":"Nuevo Abono"),m(2),g("formGroup",o.abonoForm),m(7),P("has-error",o.hasError("nombre","required")),m(4),g("ngIf",o.hasError("nombre","required")),m(11),g("disabled",o.abonoForm.invalid||o.isSubmitting),m(3),p(o.esEdicion?"Actualizar Abono":"Guardar Abono"))},dependencies:[T,E,y,S,k,w,F,I,A,j,z,h],styles:['@charset "UTF-8";.premium-nuevo-abono-container[_ngcontent-%COMP%]{padding:20px;min-height:100%;background-color:#0a1e3f;color:#fff}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:30px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]{margin-bottom:16px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:8px;padding:8px 16px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:translateY(-2px)}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#fff;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.2)}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{background:#ffffff26;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;padding:24px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:24px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fff}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ff5252;margin-left:4px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff1a;border-radius:12px;border:1px solid rgba(255,255,255,.2);overflow:hidden;transition:all .3s ease}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:focus-within{border-color:#fff6;box-shadow:0 0 0 2px #ffffff1a}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container.has-error[_ngcontent-%COMP%]{border-color:#ff5252;box-shadow:0 0 0 2px #ff525233}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:50px;color:#ffffffb3;font-size:20px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;color:#fff;padding:14px 16px 14px 0;font-size:16px;font-family:inherit}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:#ffffff80}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:8px;color:#ff5252;font-size:14px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]:before{content:"\\2022";margin-right:6px;font-size:16px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin-top:32px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;background:linear-gradient(135deg,#00796b,#4caf50);color:#fff;border:none;border-radius:12px;padding:16px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 8px 20px #0003}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;margin-right:8px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000004d}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 6px 15px #0003}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:disabled{background:#ffffff1a;color:#ffffff80;box-shadow:none;cursor:not-allowed}@media (min-width: 768px){.premium-nuevo-abono-container[_ngcontent-%COMP%]{padding:30px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{flex-direction:row;align-items:center}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]{margin-bottom:0;margin-right:20px}.premium-nuevo-abono-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.form-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.ion-content-nuevo-abono[_ngcontent-%COMP%]{--background: #0a1e3f;--padding-top: 30px}']});let u=c;return u})();export{an as NuevoAbonoPage};
