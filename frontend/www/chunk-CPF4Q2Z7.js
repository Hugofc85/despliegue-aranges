import{a as n,b as s}from"./chunk-B4WDAWNQ.js";import{f as i}from"./chunk-OM4WM6OA.js";var m=(()=>{let a=class a{constructor(){}setUsuarioIdForAdmin(r){let o=localStorage.getItem("token");if(!o){console.error("No hay token en el localStorage.");return}try{let t=o.split("."),e=JSON.parse(atob(t[0])),c=JSON.parse(atob(t[1]));c.userId=r;let u=btoa(JSON.stringify(e)),d=btoa(JSON.stringify(c)),g=`${u}.${d}.${t[2]}`;localStorage.setItem("token",g),console.log(`Token actualizado con userId=${r}`)}catch(t){console.error("Error al modificar el token:",t)}}getIdUsuario(){let r=localStorage.getItem("token");if(!r)return null;try{let o=r.split(".")[1],t=atob(o);return JSON.parse(t).userId||null}catch(o){return console.error("Error al decodificar el token:",o),null}}getUsuarioById(r){let o=`${s.url}usuarios/${r}`;return n.get({url:o,headers:{"Content-Type":"application/json"}}).then(t=>{var e;if(console.log("Usuario obtenido:",t),t.status===404||t.status===401)throw{status:t.status,message:((e=t.data)==null?void 0:e.error)||"Error desconocido"};return t.data}).catch(t=>{throw console.error("Error al obtener usuario:",t),t})}login(r={correo:"",contrasena:""}){let o=`${s.url}auth/login`;return console.log("Usuario:",JSON.stringify(r)),console.log("URL:",o),n.post({url:o,headers:{"Content-Type":"application/json"},data:r}).then(t=>{if(console.log("Respuesta del servidor:",t),t.status===404||t.status===401)throw{status:t.status,message:t.data.error};return t.data}).catch(t=>{throw console.error("Error en el login:",t),t})}registro(r={nombre:"",correo:"",contrasena:""}){let o=`${s.url}auth/registro`;return n.post({url:o,headers:{"Content-Type":"application/json"},data:r}).then(t=>{if(console.log("Respuesta del servidor:",t),t.status===404||t.status===401)throw{status:t.status,message:t.data.error};return t.data}).catch(t=>{throw console.error("Error en el login:",t),t})}};a.\u0275fac=function(o){return new(o||a)},a.\u0275prov=i({token:a,factory:a.\u0275fac,providedIn:"root"});let l=a;return l})();export{m as a};
