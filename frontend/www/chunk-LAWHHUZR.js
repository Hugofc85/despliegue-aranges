import{a as $}from"./chunk-6AVC4IZC.js";import{V as X,Z,a as K,d as U,e as H,j as J,o as Q,u as W}from"./chunk-JZDIRMBR.js";import"./chunk-B4WDAWNQ.js";import{C as q,D as B,F as R,l as Y}from"./chunk-EXSP2FB6.js";import{$ as i,A as p,Aa as y,Ab as L,Bb as G,Cb as A,D as l,Db as D,F as C,L as e,M as n,N as m,R as h,S as P,T as O,hb as w,jb as u,kb as I,l as M,lb as S,m as x,pb as T,qa as j,qb as F,rb as z,t as s,u as f,ub as N,va as k,w as v,ya as E,zb as V}from"./chunk-OM4WM6OA.js";import"./chunk-QWLURI7L.js";import"./chunk-7KGURMOZ.js";import"./chunk-746R66HB.js";import"./chunk-22YGHXDB.js";import"./chunk-A5VEOJWE.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-4DUJ2VZY.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as _}from"./chunk-RW4GY4BD.js";function en(r,d){r&1&&(e(0,"div",9)(1,"div",10),m(2,"div",11),n(),e(3,"p"),i(4,"Cargando datos del trabajador..."),n()())}function rn(r,d){if(r&1){let c=h();e(0,"div",12)(1,"div",13),m(2,"ion-icon",14),n(),e(3,"p"),i(4,"No se pudieron cargar los datos del trabajador."),n(),e(5,"button",4),P("click",function(){M(c);let t=O();return x(t.volver())}),e(6,"span"),i(7,"Volver a la lista"),n()()()}}function on(r,d){r&1&&(e(0,"div",35),i(1," El nombre es obligatorio "),n())}function an(r,d){r&1&&(e(0,"div",35),i(1," El nombre debe tener al menos 2 caracteres "),n())}function cn(r,d){r&1&&(e(0,"div",35),i(1," Los kilos no pueden ser negativos "),n())}function dn(r,d){r&1&&(e(0,"div",35),i(1," Las ganancias no pueden ser negativas "),n())}function sn(r,d){if(r&1){let c=h();e(0,"div",15)(1,"form",16),P("ngSubmit",function(){M(c);let t=O();return x(t.guardarCambios())}),e(2,"div",17)(3,"div",18)(4,"label",19),i(5,"Nombre "),e(6,"span",20),i(7,"*"),n()()(),e(8,"div",21)(9,"div",22),m(10,"ion-icon",23),n(),m(11,"input",24),n(),p(12,on,2,0,"div",25)(13,an,2,0,"div",25),n(),e(14,"div",17)(15,"div",18)(16,"label",26),i(17,"Kilos recogidos"),n()(),e(18,"div",21)(19,"div",22),m(20,"ion-icon",27),n(),m(21,"input",28),n(),p(22,cn,2,0,"div",25),n(),e(23,"div",17)(24,"div",18)(25,"label",29),i(26,"Ganancias (\u20AC)"),n()(),e(27,"div",21)(28,"div",22),m(29,"ion-icon",30),n(),m(30,"input",31),n(),p(31,dn,2,0,"div",25),n(),e(32,"div",32)(33,"button",33),m(34,"ion-icon",34),e(35,"span"),i(36,"Guardar Cambios"),n()()()()()}if(r&2){let c=O();s(),l("formGroup",c.trabajadorForm),s(7),C("has-error",c.hasError("nombre","required")||c.hasError("nombre","minlength")),s(4),l("ngIf",c.hasError("nombre","required")),s(),l("ngIf",c.hasError("nombre","minlength")),s(5),C("has-error",c.hasError("kilos","min")),s(4),l("ngIf",c.hasError("kilos","min")),s(5),C("has-error",c.hasError("ganancia","min")),s(4),l("ngIf",c.hasError("ganancia","min")),s(2),l("disabled",c.isSubmitting)}}var Mn=(()=>{let d=class d{constructor(o,t,a,g,b,nn,tn){this.formBuilder=o,this.trabajadorService=t,this.navController=a,this.toastController=g,this.loadingController=b,this.route=nn,this.router=tn,this.isSubmitting=!1,this.trabajadorId=null,this.isLoading=!0,this.loadError=!1,this.trabajadorForm=this.formBuilder.group({nombre:["",[u.required,u.minLength(2)]],kilos:[0,[u.min(0)]],ganancia:[0,[u.min(0)]]})}ngOnInit(){K({personOutline:X,basketOutline:J,cashOutline:Q,arrowBackOutline:H,saveOutline:Z,closeCircleOutline:W,alertCircleOutline:U}),this.route.paramMap.subscribe(o=>{this.trabajadorId=o.get("id"),this.trabajadorId?this.cargarDatosTrabajador(this.trabajadorId):(this.mostrarToast("No se ha especificado un trabajador para editar","danger"),this.isLoading=!1,this.loadError=!0)})}cargarDatosTrabajador(o){return _(this,null,function*(){try{let t=yield this.trabajadorService.getTrabajadorById(parseInt(o));t?(this.trabajadorForm.patchValue({nombre:t[0].nombre||"",kilos:t[0].kilos||0,ganancia:t[0].ganancia||0}),this.isLoading=!1):(this.mostrarToast("No se encontr\xF3 el trabajador especificado","danger"),this.isLoading=!1,this.loadError=!0)}catch(t){console.error("Error al cargar los datos del trabajador:",t),this.mostrarToast("Error al cargar los datos del trabajador","danger"),this.isLoading=!1,this.loadError=!0}})}get f(){return this.trabajadorForm.controls}hasError(o,t){let a=this.f[o];return a.hasError(t)&&(a.dirty||a.touched)}volver(){this.navController.back()}guardarCambios(){return _(this,null,function*(){var o,t,a;if(Object.keys(this.f).forEach(g=>{this.f[g].markAsTouched()}),this.trabajadorForm.invalid){this.mostrarToast("Por favor, completa correctamente todos los campos obligatorios","danger");return}if(!this.trabajadorId){this.mostrarToast("No se ha especificado un trabajador para editar","danger");return}try{this.isSubmitting=!0;let g=yield this.loadingController.create({message:"Guardando cambios...",spinner:"circles"});yield g.present();let b={id:this.trabajadorId,nombre:(o=this.trabajadorForm.get("nombre"))==null?void 0:o.value,kilos:(t=this.trabajadorForm.get("kilos"))==null?void 0:t.value,ganancia:(a=this.trabajadorForm.get("ganancia"))==null?void 0:a.value};yield this.trabajadorService.updateTrabajador(parseInt(this.trabajadorId),b),yield g.dismiss(),this.mostrarToast("Trabajador actualizado correctamente","success"),this.volver()}catch(g){console.error("Error al actualizar el trabajador:",g),this.isSubmitting=!1,this.loadingController.dismiss(),this.mostrarToast("Error al actualizar el trabajador. Int\xE9ntalo de nuevo.","danger")}})}mostrarToast(o,t="primary"){return _(this,null,function*(){yield(yield this.toastController.create({message:o,duration:3e3,position:"bottom",color:t,buttons:[{icon:"close-circle-outline",role:"cancel"}]})).present()})}};d.\u0275fac=function(t){return new(t||d)(f(L),f($),f(D),f(B),f(q),f(E),f(y))},d.\u0275cmp=v({type:d,selectors:[["app-formulario-editar"]],decls:13,vars:3,consts:[[1,"ion-content-editar-trabajador"],[1,"premium-editar-trabajador-container"],[1,"section-header"],[1,"header-back-button"],[1,"back-button",3,"click"],["name","arrow-back-outline"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","form-container",4,"ngIf"],[1,"loading-container"],[1,"loading-spinner"],[1,"spinner"],[1,"error-container"],[1,"error-icon"],["name","alert-circle-outline"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-label"],["for","nombre"],[1,"required"],[1,"input-container"],[1,"input-icon"],["name","person-outline"],["type","text","id","nombre","formControlName","nombre","placeholder","Nombre del trabajador",1,"form-input"],["class","error-message",4,"ngIf"],["for","kilos"],["name","basket-outline"],["type","number","id","kilos","formControlName","kilos","placeholder","0","min","0",1,"form-input"],["for","ganancia"],["name","cash-outline"],["type","number","id","ganancia","formControlName","ganancia","placeholder","0","min","0","step","0.01",1,"form-input"],[1,"form-actions"],["type","submit",1,"save-button",3,"disabled"],["name","save-outline"],[1,"error-message"]],template:function(t,a){t&1&&(e(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),P("click",function(){return a.volver()}),m(5,"ion-icon",5),e(6,"span"),i(7,"Volver"),n()()(),e(8,"h1"),i(9,"Editar Trabajador"),n()(),p(10,en,5,0,"div",6)(11,rn,8,0,"div",7)(12,sn,37,12,"div",8),n()()),t&2&&(s(10),l("ngIf",a.isLoading),s(),l("ngIf",a.loadError),s(),l("ngIf",!a.isLoading&&!a.loadError))},dependencies:[Y,k,j,G,T,w,F,I,S,V,R,A,z,N],styles:['@charset "UTF-8";.premium-editar-trabajador-container[_ngcontent-%COMP%]{padding:20px;min-height:100%;background-color:#0a1e3f;color:#fff}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:30px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]{margin-bottom:16px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:8px;padding:8px 16px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:translateY(-2px)}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#fff;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.2)}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;background:#ffffff1a;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{margin-bottom:20px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#4caf50;animation:_ngcontent-%COMP%_spin 1s linear infinite}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#ffffffe6;text-align:center;margin:0}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;background:#ffffff1a;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{margin-bottom:20px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:50px;color:#ff5252}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#ffffffe6;text-align:center;margin:0 0 20px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:8px;padding:8px 16px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:translateY(-2px)}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{background:#ffffff26;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;padding:24px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:24px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fff}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ff5252;margin-left:4px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff1a;border-radius:12px;border:1px solid rgba(255,255,255,.2);overflow:hidden;transition:all .3s ease}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:focus-within{border-color:#fff6;box-shadow:0 0 0 2px #ffffff1a}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container.has-error[_ngcontent-%COMP%]{border-color:#ff5252;box-shadow:0 0 0 2px #ff525233}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:50px;color:#ffffffb3;font-size:20px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;color:#fff;padding:14px 16px 14px 0;font-size:16px;font-family:inherit}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:#ffffff80}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, .premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:8px;color:#ff5252;font-size:14px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]:before{content:"\\2022";margin-right:6px;font-size:16px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin-top:32px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;background:linear-gradient(135deg,#00796b,#4caf50);color:#fff;border:none;border-radius:12px;padding:16px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 8px 20px #0003}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;margin-right:8px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000004d}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 6px 15px #0003}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:disabled{background:#ffffff1a;color:#ffffff80;box-shadow:none;cursor:not-allowed}@media (min-width: 768px){.premium-editar-trabajador-container[_ngcontent-%COMP%]{padding:30px}.premium-editar-trabajador-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%], .premium-editar-trabajador-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%], .premium-editar-trabajador-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.form-container[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.ion-content-editar-trabajador[_ngcontent-%COMP%]{--padding-top: 30px;--background: #0a1e3f}[_nghost-%COMP%]     ion-toast{--background: #162b4d;--color: #ffffff;--border-radius: 8px;--box-shadow: 0 4px 16px rgba(0, 0, 0, .2)}[_nghost-%COMP%]     ion-toast.toast-success{--background: #4caf50}[_nghost-%COMP%]     ion-toast.toast-danger{--background: #ff5252}']});let r=d;return r})();export{Mn as FormularioEditarPage};
