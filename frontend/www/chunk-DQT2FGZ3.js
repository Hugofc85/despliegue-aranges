import{a as X}from"./chunk-2JKHKBYW.js";import{f as Q,h as W}from"./chunk-GZLC3ZNG.js";import"./chunk-TK637REM.js";import"./chunk-PSDQXRQ7.js";import"./chunk-YYK6W2VS.js";import"./chunk-FAPPJNJW.js";import"./chunk-HC6MZPB3.js";import"./chunk-4PGTP63H.js";import"./chunk-QRJ5Z3B6.js";import"./chunk-FERD25SW.js";import"./chunk-PCR4Q3CI.js";import"./chunk-LEIMCQKJ.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-E76BAXQI.js";import"./chunk-MCRJI3T3.js";import"./chunk-B4WDAWNQ.js";import{$ as J,K as U,X as $,Z as H,a as B,d as L,e as R,fa as K}from"./chunk-JZDIRMBR.js";import"./chunk-KJ4DQJJ6.js";import"./chunk-4DDT52NB.js";import"./chunk-5U5GTFKZ.js";import"./chunk-XDLFVO2Q.js";import{F as G,l as D}from"./chunk-2UXU5CYN.js";import{$ as f,A as O,Aa as E,Bb as A,Ca as F,Cb as q,D as l,Eb as Y,F as w,L as n,M as e,N as c,R as M,S as u,T as p,aa as y,jb as S,l as _,lb as P,m as C,mb as I,nb as z,qa as k,rb as T,sb as V,t as m,tb as j,u as d,w as v,wb as N}from"./chunk-IIYMI45M.js";import"./chunk-QWLURI7L.js";import"./chunk-7KGURMOZ.js";import"./chunk-746R66HB.js";import"./chunk-22YGHXDB.js";import"./chunk-A5VEOJWE.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-4DUJ2VZY.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as x,b as h,f as g}from"./chunk-RW4GY4BD.js";function nt(i,s){i&1&&(n(0,"div",10)(1,"div",11),c(2,"div",12),e(),n(3,"p"),f(4,"Cargando datos del fitosanitario..."),e()())}function et(i,s){if(i&1){let a=M();n(0,"div",13)(1,"div",14),c(2,"ion-icon",15),e(),n(3,"p"),f(4),e(),n(5,"button",16),u("click",function(){_(a);let o=p();return C(o.cargarFito())}),c(6,"ion-icon",17),n(7,"span"),f(8,"Reintentar"),e()()()}if(i&2){let a=p();m(4),y(a.errorMessage)}}function ot(i,s){i&1&&(n(0,"div",36),f(1," El nombre es obligatorio "),e())}function it(i,s){if(i&1){let a=M();n(0,"div",18)(1,"form",19),u("ngSubmit",function(){_(a);let o=p();return C(o.guardarFito())}),n(2,"div",20)(3,"div",21)(4,"label",22),f(5,"Nombre "),n(6,"span",23),f(7,"*"),e()()(),n(8,"div",24)(9,"div",25),c(10,"ion-icon",26),e(),c(11,"input",27),e(),O(12,ot,2,0,"div",28),e(),n(13,"div",20)(14,"div",21)(15,"label",29),f(16,"Cantidad"),e()(),n(17,"div",24)(18,"div",25),c(19,"ion-icon",30),e(),c(20,"input",31),e()(),c(21,"input",32),n(22,"div",33)(23,"button",34),c(24,"ion-icon",35),n(25,"span"),f(26,"Actualizar Fitosanitario"),e()()()()()}if(i&2){let a=p();m(),l("formGroup",a.fitoForm),m(7),w("has-error",a.hasError("nombre","required")),m(4),l("ngIf",a.hasError("nombre","required")),m(11),l("disabled",a.fitoForm.invalid||a.isSubmitting)}}var ut=(()=>{let s=class s{constructor(t,o,r,b,Z,tt){this.formBuilder=t,this.router=o,this.route=r,this.abonoService=b,this.alertController=Z,this.toastController=tt,this.isSubmitting=!1,this.isLoading=!1,this.loadError=!1,this.errorMessage="",this.fitoForm=this.createForm(),this.fitoId=parseInt(this.route.snapshot.paramMap.get("id")||"0")}ngOnInit(){B({arrowBackOutline:R,alertCircleOutline:L,refreshOutline:$,shieldCheckmarkOutline:J,layersOutline:U,saveOutline:H,trashOutline:K}),this.fitoId?this.cargarFito():(this.errorMessage="ID de fitosanitario no v\xE1lido",this.loadError=!0)}createForm(){return this.formBuilder.group({nombre:["",[P.required]],cantidad:[null],tipo:["fito"],idUsuario:[null,[P.required]]})}cargarFito(){return g(this,null,function*(){this.isLoading=!0,this.loadError=!1;try{if(this.fitoOriginal=yield this.abonoService.getAbonoById(this.fitoId),this.fitoOriginal.tipo!=="fito")throw new Error("El elemento no es un fitosanitario");this.fitoForm.patchValue({nombre:this.fitoOriginal.nombre,cantidad:this.fitoOriginal.cantidad,tipo:this.fitoOriginal.tipo||"fito",idUsuario:this.fitoOriginal.idUsuario})}catch(t){console.error("Error al cargar fitosanitario:",t),this.loadError=!0,this.errorMessage="Error al cargar los datos del fitosanitario. Verifica tu conexi\xF3n e int\xE9ntalo de nuevo."}finally{this.isLoading=!1}})}hasError(t,o){let r=this.fitoForm.get(t);return!!(r&&r.hasError(o)&&(r.dirty||r.touched))}guardarFito(){return g(this,null,function*(){if(this.fitoForm.invalid){this.markFormGroupTouched();return}this.isSubmitting=!0;try{let t=h(x({},this.fitoForm.value),{tipo:"fito"});yield this.abonoService.updateAbono(this.fitoId,t),yield this.mostrarToast("Fitosanitario actualizado correctamente","success"),this.volver()}catch(t){console.error("Error al actualizar fitosanitario:",t),yield this.mostrarToast("Error al actualizar el fitosanitario","danger")}finally{this.isSubmitting=!1}})}confirmarEliminar(){return g(this,null,function*(){if(!this.fitoOriginal)return;yield(yield this.alertController.create({header:"Confirmar eliminaci\xF3n",message:`\xBFEst\xE1s seguro de que quieres eliminar el fitosanitario "${this.fitoOriginal.nombre}"?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"destructive",handler:()=>{this.eliminarFito()}}]})).present()})}eliminarFito(){return g(this,null,function*(){this.isSubmitting=!0;try{yield this.abonoService.deleteAbono(this.fitoId),yield this.mostrarToast("Fitosanitario eliminado correctamente","success"),this.volver()}catch(t){console.error("Error al eliminar fitosanitario:",t),yield this.mostrarToast("Error al eliminar el fitosanitario","danger")}finally{this.isSubmitting=!1}})}markFormGroupTouched(){Object.keys(this.fitoForm.controls).forEach(t=>{let o=this.fitoForm.get(t);o&&o.markAsTouched()})}volver(){this.router.navigate(["/fitos"])}mostrarToast(t,o){return g(this,null,function*(){yield(yield this.toastController.create({message:t,duration:3e3,color:o,position:"bottom"})).present()})}};s.\u0275fac=function(o){return new(o||s)(d(q),d(F),d(E),d(X),d(Q),d(W))},s.\u0275cmp=v({type:s,selectors:[["app-editar-fito"]],decls:14,vars:3,consts:[[1,"ion-content-editar-fito"],[1,"premium-editar-fito-container"],[1,"section-header"],[1,"header-back-button"],[1,"back-button",3,"click"],["name","arrow-back-outline"],[1,"header-content"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","form-container",4,"ngIf"],[1,"loading-container"],[1,"loading-spinner"],[1,"spinner"],[1,"error-container"],[1,"error-icon"],["name","alert-circle-outline"],[1,"retry-button",3,"click"],["name","refresh-outline"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-label"],["for","nombre"],[1,"required"],[1,"input-container"],[1,"input-icon"],["name","shield-checkmark-outline"],["type","text","id","nombre","formControlName","nombre","placeholder","Nombre del fitosanitario",1,"form-input"],["class","error-message",4,"ngIf"],["for","cantidad"],["name","layers-outline"],["type","number","id","cantidad","formControlName","cantidad","placeholder","Cantidad disponible","min","0",1,"form-input"],["type","hidden","formControlName","tipo","value","fito"],[1,"form-actions"],["type","submit",1,"save-button",3,"disabled"],["name","save-outline"],[1,"error-message"]],template:function(o,r){o&1&&(n(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),u("click",function(){return r.volver()}),c(5,"ion-icon",5),n(6,"span"),f(7,"Volver"),e()()(),n(8,"div",6)(9,"h1"),f(10,"Editar Fitosanitario"),e()()(),O(11,nt,5,0,"div",7)(12,et,9,1,"div",8)(13,it,27,5,"div",9),e()()),o&2&&(m(11),l("ngIf",r.isLoading),m(),l("ngIf",r.loadError),m(),l("ngIf",!r.isLoading&&!r.loadError))},dependencies:[G,Y,T,S,V,I,z,A,j,N,D,k],styles:['@charset "UTF-8";.premium-editar-fito-container[_ngcontent-%COMP%]{padding:20px;min-height:100%;background-color:#0a1e3f;color:#fff}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:30px}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]{margin-bottom:16px}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:8px;padding:8px 16px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:translateY(-2px)}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#fff;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.2)}.premium-editar-fito-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;background:#ffffff1a;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-fito-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{margin-bottom:20px}.premium-editar-fito-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#ff9800;animation:_ngcontent-%COMP%_spin 1s linear infinite}.premium-editar-fito-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#ffffffe6;text-align:center;margin:0}.premium-editar-fito-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;background:#ffffff1a;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-fito-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{margin-bottom:20px}.premium-editar-fito-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:50px;color:#ff5252}.premium-editar-fito-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#ffffffe6;text-align:center;margin:0 0 20px}.premium-editar-fito-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff26;border:1px solid rgba(255,255,255,.3);border-radius:8px;padding:8px 16px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.premium-editar-fito-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.premium-editar-fito-container[_ngcontent-%COMP%]   .error-container[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:translateY(-2px)}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{background:#ffffff26;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;padding:24px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 20px #00000040}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:24px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fff}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ff5252;margin-left:4px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;align-items:center;background:#ffffff1a;border-radius:12px;border:1px solid rgba(255,255,255,.2);overflow:hidden;transition:all .3s ease}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:focus-within{border-color:#fff6;box-shadow:0 0 0 2px #ffffff1a}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container.has-error[_ngcontent-%COMP%]{border-color:#ff5252;box-shadow:0 0 0 2px #ff525233}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:50px;color:#ffffffb3;font-size:20px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;color:#fff;padding:14px 16px 14px 0;font-size:16px;font-family:inherit}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:#ffffff80}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:8px;color:#ff5252;font-size:14px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]:before{content:"\\2022";margin-right:6px;font-size:16px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin-top:32px;display:flex;flex-direction:column;gap:12px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;background:linear-gradient(135deg,#00796b,#4caf50);color:#fff;border:none;border-radius:12px;padding:16px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 8px 20px #0003}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;margin-right:8px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000004d}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 6px 15px #0003}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:disabled{background:#ffffff1a;color:#ffffff80;box-shadow:none;cursor:not-allowed}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;background:linear-gradient(135deg,#ff5252,#d32f2f);color:#fff;border:none;border-radius:12px;padding:16px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 8px 20px #0003}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;margin-right:8px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000004d}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 6px 15px #0003}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]:disabled{background:#ffffff1a;color:#ffffff80;box-shadow:none;cursor:not-allowed}@media (min-width: 768px){.premium-editar-fito-container[_ngcontent-%COMP%]{padding:30px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{flex-direction:row;gap:16px}.premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%], .premium-editar-fito-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{flex:1}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{flex-direction:row;align-items:center}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-back-button[_ngcontent-%COMP%]{margin-bottom:0;margin-right:20px}.premium-editar-fito-container[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.form-container[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.ion-content-editar-fito[_ngcontent-%COMP%]{--background: #0a1e3f}']});let i=s;return i})();export{ut as EditarFitoPage};
