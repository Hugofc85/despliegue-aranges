import{a as c,b as e}from"./chunk-B4WDAWNQ.js";import{a as d,f as l}from"./chunk-OM4WM6OA.js";import{a as i}from"./chunk-RW4GY4BD.js";var b=(()=>{let u=class u{constructor(){this.token=localStorage.getItem("token"),this.productosSubject=new d([]),this.productos$=this.productosSubject.asObservable()}getAllProductos(){let r=`${e.url}productos`;return c.get({url:r,headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}}).then(o=>{if(console.log("Productos obtenidos:",o),this.productosSubject.next(o.data),o.status===404||o.status===401)throw{status:o.status,message:o.data.error};return o.data}).catch(o=>{throw console.error("Error al obtener productos:",o),o})}getProductoById(r){let o=`${e.url}productos/${r}`;return c.get({url:o,headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}}).then(t=>{if(console.log("Producto obtenido:",t),t.status===404||t.status===401)throw{status:t.status,message:t.data.error};return t.data}).catch(t=>{throw console.error("Error al obtener el producto:",t),t})}getProductosByUsuarioId(r){let o=`${e.url}productos/usuario/${r}`;return c.get({url:o,headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}}).then(t=>{if(console.log("Productos obtenidos por usuario:",t),this.productosSubject.next(t.data),t.status===404||t.status===401)throw{status:t.status,message:t.data.error};return t.data}).catch(t=>{throw console.error("Error al obtener productos por usuario:",t),t})}createProducto(r){let o=`${e.url}productos`;return console.log("Creando producto:",r),c.post({url:o,headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"},data:r}).then(t=>{let a=this.productosSubject.getValue();if(this.productosSubject.next([...a,t.data]),t.status===404||t.status===401)throw{status:t.status,message:t.data.error};return t.data}).catch(t=>{throw console.error("Error al crear producto:",t),t})}updateProducto(r,o){let t=`${e.url}productos/${r}`;return console.log("Actualizando producto:",o),c.put({url:t,headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"},data:o}).then(a=>{if(console.log("Producto actualizado:",a),a.status===404||a.status===401)throw{status:a.status,message:a.data.error};return this.reemplazarProducto(r,o),a.data}).catch(a=>{throw console.error("Error al actualizar producto:",a),a})}deleteProducto(r){let o=`${e.url}productos/${r}`;return c.delete({url:o,headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}}).then(t=>{if(console.log("Producto eliminado:",t),t.status===404||t.status===401)throw{status:t.status,message:t.data.error};return this.borrarProducto(r),t.data}).catch(t=>{throw console.error("Error al eliminar producto:",t),t})}reemplazarProducto(r,o){let t=this.productosSubject.getValue().map(a=>a.id===r?i(i({},a),o):a);this.productosSubject.next(t)}borrarProducto(r){let o=this.productosSubject.getValue().filter(t=>t.id!==r);this.productosSubject.next(o)}};u.\u0275fac=function(o){return new(o||u)},u.\u0275prov=l({token:u,factory:u.\u0275fac,providedIn:"root"});let s=u;return s})();export{b as a};
