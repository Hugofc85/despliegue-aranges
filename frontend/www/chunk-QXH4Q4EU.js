import{a as u}from"./chunk-PBAUZABJ.js";import{a as i,b as p}from"./chunk-B4WDAWNQ.js";import{f as d,h}from"./chunk-64PFJSTE.js";import{f as l}from"./chunk-RW4GY4BD.js";var T=(()=>{let e=class e{constructor(r){this.trabajadorService=r,this.baseUrl=`${p.url}recogidas`}handleError(r){throw console.error("Error en recogida.service:",r),r}actualizarTotalesTrabajador(r){return l(this,null,function*(){try{let t=(yield this.getAllByTrabajador(parseInt(r))).reduce((g,j)=>g+j.kilos,0),o=yield this.trabajadorService.getTrabajadorById(parseInt(r)),n=o[0].precioPorKilo||1.5,b=t*n,s={id:o[0].id,nombre:o[0].nombre,kilos:t,ganancia:b,precioPorKilo:n};return console.log(s),yield this.trabajadorService.updateTrabajador(parseInt(r),s),!0}catch(a){throw console.error(`Error al actualizar totales del trabajador ${r}:`,a),a}})}getAllByTrabajador(r){let a=`${this.baseUrl}/${r}`;return i.get({url:a}).then(t=>t.data).catch(this.handleError)}getById(r){let a=`${this.baseUrl}/recogida/${r}`;return i.get({url:a}).then(t=>t.data).catch(this.handleError)}getByFechaAndTrabajador(r,a){let t=`${this.baseUrl}/buscar-por-fecha?fecha=${r}&idTrabajador=${a}`;return i.get({url:t}).then(o=>o.data).catch(this.handleError)}createRecogida(r){let a=`${this.baseUrl}`;return i.post({url:a,headers:{"Content-Type":"application/json"},data:r}).then(t=>t.data).catch(this.handleError)}updateRecogida(r,a){let t=`${this.baseUrl}/${r}`;return i.put({url:t,headers:{"Content-Type":"application/json"},data:a}).then(o=>o.data).catch(this.handleError)}deleteRecogida(r){let a=`${this.baseUrl}/${r}`;return i.delete({url:a}).then(()=>{}).catch(this.handleError)}};e.\u0275fac=function(a){return new(a||e)(h(u))},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let c=e;return c})();export{T as a};
