import{a as g}from"./chunk-NJDPUEXS.js";import{a as s,b as u}from"./chunk-B4WDAWNQ.js";import{f as d,h as l}from"./chunk-OM4WM6OA.js";import{f as h}from"./chunk-RW4GY4BD.js";var y=(()=>{let a=class a{constructor(r){this.trabajadorService=r,this.baseUrl=`${u.url}recogidas`}getAuthHeaders(){return{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}handleError(r){throw console.error("Error en recogidas.service:",r),r}actualizarTotalesTrabajador(r){return h(this,null,function*(){try{let e=(yield this.getAllByTrabajador(parseInt(r))).reduce((b,j)=>b+j.kilos,0),o=yield this.trabajadorService.getTrabajadorById(parseInt(r)),c=o[0].precioPorKilo||1.5,p=e*c,n={id:o[0].id,nombre:o[0].nombre,kilos:e,ganancia:p,precioPorKilo:c};return console.log(n),yield this.trabajadorService.updateTrabajador(parseInt(r),n),!0}catch(t){throw console.error(`Error al actualizar totales del trabajador ${r}:`,t),t}})}getAllByTrabajador(r){let t=`${this.baseUrl}/${r}`;return s.get({url:t,headers:this.getAuthHeaders()}).then(e=>e.data).catch(this.handleError)}getById(r){let t=`${this.baseUrl}/recogida/${r}`;return s.get({url:t,headers:this.getAuthHeaders()}).then(e=>e.data).catch(this.handleError)}getByFechaAndTrabajador(r,t){let e=`${this.baseUrl}/buscar-por-fecha?fecha=${r}&idTrabajador=${t}`;return s.get({url:e,headers:this.getAuthHeaders()}).then(o=>o.data).catch(this.handleError)}createRecogida(r){let t=`${this.baseUrl}`;return s.post({url:t,headers:this.getAuthHeaders(),data:r}).then(e=>e.data).catch(this.handleError)}updateRecogida(r,t){let e=`${this.baseUrl}/${r}`;return s.put({url:e,headers:this.getAuthHeaders(),data:t}).then(o=>o.data).catch(this.handleError)}deleteRecogida(r){let t=`${this.baseUrl}/${r}`;return s.delete({url:t,headers:this.getAuthHeaders()}).then(()=>{}).catch(this.handleError)}};a.\u0275fac=function(t){return new(t||a)(l(g))},a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let i=a;return i})();export{y as a};
